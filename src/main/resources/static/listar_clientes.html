<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Lista de Clientes</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    body {
      background-color: #f8f9fa;
    }
    .container {
      margin-top: 50px;
    }
    h2 {
      text-align: center;
      margin-bottom: 30px;
      color: #343a40;
    }
    table {
      background-color: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.15);
    }
  </style>
</head>
<body>

<div class="container">
  <h2>Lista de Clientes</h2>
  <div class="mb-3 text-end">
    <a href="formulario_cliente.html" class="btn btn-primary">‚ûï Nuevo Cliente</a>
  </div>

  <table class="table table-striped table-hover">
    <thead class="table-dark">
      <tr>
        <th>C√©dula</th>
        <th>Nombre</th>
        <th>Primer Apellido</th>
        <th>Segundo Apellido</th>
        <th>Correo</th>
        <th>Tel√©fono</th>
        <th>Direcci√≥n</th>
        <th>Acciones</th>
      </tr>
    </thead>
    <tbody id="tablaClientes">
      <!-- Filas generadas por JS -->
    </tbody>
  </table>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
const API_URL = "http://localhost:9090/api/clientes"; // Ajusta seg√∫n tu backend

// Cargar todos los clientes
async function cargarClientes() {
  try {
    const resp = await fetch(API_URL);
    if (!resp.ok) throw new Error("Error al cargar clientes");
    const clientes = await resp.json();

    const tabla = document.getElementById("tablaClientes");
    tabla.innerHTML = ""; // limpiar tabla

    clientes.forEach(cliente => {
      const fila = document.createElement("tr");

      fila.innerHTML = `
        <td>${cliente.cedula}</td>
        <td>${cliente.nombre}</td>
        <td>${cliente.apellido1}</td>
        <td>${cliente.apellido2 || ''}</td>
        <td>${cliente.correo}</td>
        <td>${cliente.telefono || ''}</td>
        <td>${cliente.direccion || ''}</td>
        <td>
          <a href="form_cliente.html?cedula=${cliente.cedula}" class="btn btn-sm btn-warning mb-1">‚úèÔ∏è Editar</a>
          <button class="btn btn-sm btn-danger" onclick="eliminarCliente(${cliente.cedula})">üóëÔ∏è Eliminar</button>
        </td>
      `;

      tabla.appendChild(fila);
    });

  } catch (error) {
    console.error(error);
    alert("Error al cargar clientes.");
  }
}

// Eliminar cliente
async function eliminarCliente(cedula) {
  if (!confirm("¬øEst√°s seguro de eliminar este cliente?")) return;

  try {
    const resp = await fetch(`${API_URL}/${cedula}`, { method: "DELETE" });
    if (resp.ok) {
      alert("Cliente eliminado correctamente");
      cargarClientes();
    } else {
      alert("Error al eliminar cliente");
    }
  } catch (error) {
    console.error(error);
    alert("Error al conectar con la API");
  }
}

window.onload = cargarClientes;
</script>

</body>
</html>
